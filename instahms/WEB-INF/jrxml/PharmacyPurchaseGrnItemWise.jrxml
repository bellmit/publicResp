<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="report name" pageWidth="842" pageHeight="595" orientation="Landscape" whenNoDataType="NoDataSection" columnWidth="802" leftMargin="20" rightMargin="20" topMargin="40" bottomMargin="40">
	<parameter name="groupBy" class="java.lang.String" isForPrompting="false">
		<defaultValueExpression><![CDATA["dept_name"]]></defaultValueExpression>
	</parameter>
	<parameter name="filterBy" class="java.lang.String" isForPrompting="false">
		<defaultValueExpression><![CDATA["supplier_name"]]></defaultValueExpression>
	</parameter>
	<parameter name="fromDate" class="java.sql.Date" isForPrompting="false">
		<defaultValueExpression><![CDATA[java.sql.Date.valueOf("2000-01-01")]]></defaultValueExpression>
	</parameter>
	<parameter name="toDate" class="java.sql.Date" isForPrompting="false">
		<defaultValueExpression><![CDATA[java.sql.Date.valueOf("2050-12-31")]]></defaultValueExpression>
	</parameter>
	<parameter name="filterValue" class="java.lang.String" isForPrompting="false">
		<defaultValueExpression><![CDATA["*"]]></defaultValueExpression>
	</parameter>
	<parameter name="groupByName" class="java.lang.String" isForPrompting="false">
		<defaultValueExpression><![CDATA["Store"]]></defaultValueExpression>
	</parameter>
	<queryString>
		<![CDATA[SELECT supplier_name,grn_date, medicine_name, manf_mnemonic,
  batch_no,tax_name,case when tax_name='CST' then cst_rate else itemwise_tax_per end as itemwise_tax_per,bonus_qty,billed_qty,cost_price,itemwise_discount,itemwise_tax_amount,
  ((billed_qty/issue_base_unit)*cost_price-itemwise_discount+itemwise_tax_amount) as net_amount,store_name,
  $P!{groupBy} as group_name
FROM store_purchase_item_report_view
WHERE date(grn_date) BETWEEN $P{fromDate} AND $P{toDate}
  AND ( ($P{filterValue} = '*') OR ($P!{filterBy}=$P{filterValue} )
    OR ($P{filterValue} = '' AND $P!{filterBy} IS NULL) )
ORDER BY store_name,$P!{groupBy}]]>
	</queryString>
	<field name="supplier_name" class="java.lang.String"/>
	<field name="medicine_name" class="java.lang.String"/>
	<field name="manf_mnemonic" class="java.lang.String"/>
	<field name="batch_no" class="java.lang.String"/>
	<field name="tax_name" class="java.lang.String"/>
	<field name="itemwise_tax_per" class="java.math.BigDecimal"/>
	<field name="bonus_qty" class="java.math.BigDecimal"/>
	<field name="billed_qty" class="java.math.BigDecimal"/>
	<field name="cost_price" class="java.math.BigDecimal"/>
	<field name="itemwise_discount" class="java.math.BigDecimal"/>
	<field name="itemwise_tax_amount" class="java.math.BigDecimal"/>
	<field name="net_amount" class="java.math.BigDecimal"/>
	<field name="store_name" class="java.lang.String"/>
	<field name="group_name" class="java.lang.String"/>
	<variable name="sub_total_discount" class="java.math.BigDecimal" resetType="Group" resetGroup="user" calculation="Sum">
		<variableExpression><![CDATA[$F{itemwise_discount}]]></variableExpression>
	</variable>
	<variable name="sub_total_tax" class="java.math.BigDecimal" resetType="Group" resetGroup="user" calculation="Sum">
		<variableExpression><![CDATA[$F{itemwise_tax_amount}]]></variableExpression>
	</variable>
	<variable name="sub_total_net_amt" class="java.math.BigDecimal" resetType="Group" resetGroup="user" calculation="Sum">
		<variableExpression><![CDATA[$F{net_amount}]]></variableExpression>
	</variable>
	<variable name="tot_discount" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{itemwise_discount}]]></variableExpression>
	</variable>
	<variable name="tot_tax" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{itemwise_tax_amount}]]></variableExpression>
	</variable>
	<variable name="tot_amt" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{net_amount}]]></variableExpression>
	</variable>
	<variable name="store_sub_discount_total" class="java.math.BigDecimal" resetType="Group" resetGroup="defalut" calculation="Sum">
		<variableExpression><![CDATA[$F{itemwise_discount}]]></variableExpression>
	</variable>
	<variable name="store_sub_tax_total" class="java.math.BigDecimal" resetType="Group" resetGroup="defalut" calculation="Sum">
		<variableExpression><![CDATA[$F{itemwise_tax_amount}]]></variableExpression>
	</variable>
	<variable name="store_sub_net_amt_total" class="java.math.BigDecimal" resetType="Group" resetGroup="defalut" calculation="Sum">
		<variableExpression><![CDATA[$F{net_amount}]]></variableExpression>
	</variable>
	<group name="grand_total">
		<groupHeader>
			<band/>
		</groupHeader>
		<groupFooter>
			<band height="15">
				<staticText>
					<reportElement x="4" y="1" width="554" height="13"/>
					<textElement textAlignment="Right">
						<font isBold="true" pdfFontName="Helvetica-Bold"/>
					</textElement>
					<text><![CDATA[Grand Totals:]]></text>
				</staticText>
				<textField pattern="0.00">
					<reportElement x="559" y="2" width="70" height="13"/>
					<textElement textAlignment="Right">
						<font isBold="true" pdfFontName="Helvetica-Bold"/>
					</textElement>
					<textFieldExpression class="java.math.BigDecimal"><![CDATA[$V{tot_discount}]]></textFieldExpression>
				</textField>
				<textField pattern="0.00">
					<reportElement x="628" y="2" width="70" height="13"/>
					<textElement textAlignment="Right">
						<font isBold="true" pdfFontName="Helvetica-Bold"/>
					</textElement>
					<textFieldExpression class="java.math.BigDecimal"><![CDATA[$V{tot_tax}]]></textFieldExpression>
				</textField>
				<textField pattern="0.00">
					<reportElement x="697" y="2" width="70" height="13"/>
					<textElement textAlignment="Right">
						<font isBold="true" pdfFontName="Helvetica-Bold"/>
					</textElement>
					<textFieldExpression class="java.math.BigDecimal"><![CDATA[$V{tot_amt}]]></textFieldExpression>
				</textField>
			</band>
		</groupFooter>
	</group>
	<group name="defalut">
		<groupExpression><![CDATA[$F{store_name}]]></groupExpression>
		<groupHeader>
			<band height="17">
				<staticText>
					<reportElement x="4" y="2" width="60" height="14"/>
					<textElement>
						<font size="9" isBold="true" pdfFontName="Helvetica-Bold"/>
					</textElement>
					<text><![CDATA[Store Name:]]></text>
				</staticText>
				<textField>
					<reportElement x="64" y="2" width="193" height="15"/>
					<textElement>
						<font size="9" isBold="true" pdfFontName="Helvetica-Bold"/>
					</textElement>
					<textFieldExpression class="java.lang.String"><![CDATA[$F{store_name}]]></textFieldExpression>
				</textField>
			</band>
		</groupHeader>
		<groupFooter>
			<band height="17">
				<line>
					<reportElement x="0" y="1" width="802" height="1" forecolor="#A6A6A6"/>
				</line>
				<line>
					<reportElement x="0" y="16" width="802" height="1" forecolor="#A6A6A6"/>
				</line>
				<staticText>
					<reportElement x="0" y="3" width="558" height="13"/>
					<textElement textAlignment="Right">
						<font isBold="true" pdfFontName="Helvetica-Bold"/>
					</textElement>
					<text><![CDATA[ Totals:]]></text>
				</staticText>
				<textField>
					<reportElement x="257" y="3" width="263" height="13"/>
					<textElement textAlignment="Right">
						<font isBold="true" pdfFontName="Helvetica-Bold"/>
					</textElement>
					<textFieldExpression class="java.lang.String"><![CDATA[$F{store_name}]]></textFieldExpression>
				</textField>
				<textField pattern="0.00">
					<reportElement x="559" y="2" width="70" height="13"/>
					<textElement textAlignment="Right">
						<font isBold="true" pdfFontName="Helvetica-Bold"/>
					</textElement>
					<textFieldExpression class="java.math.BigDecimal"><![CDATA[$V{store_sub_discount_total}]]></textFieldExpression>
				</textField>
				<textField pattern="0.00">
					<reportElement x="628" y="2" width="70" height="13"/>
					<textElement textAlignment="Right">
						<font isBold="true" pdfFontName="Helvetica-Bold"/>
					</textElement>
					<textFieldExpression class="java.math.BigDecimal"><![CDATA[$V{store_sub_tax_total}]]></textFieldExpression>
				</textField>
				<textField pattern="0.00">
					<reportElement x="697" y="2" width="70" height="13"/>
					<textElement textAlignment="Right">
						<font isBold="true" pdfFontName="Helvetica-Bold"/>
					</textElement>
					<textFieldExpression class="java.math.BigDecimal"><![CDATA[$V{store_sub_net_amt_total}]]></textFieldExpression>
				</textField>
			</band>
		</groupFooter>
	</group>
	<group name="user">
		<groupExpression><![CDATA[$F{group_name}]]></groupExpression>
		<groupHeader>
			<band height="18">
				<textField isBlankWhenNull="true">
					<reportElement x="108" y="5" width="163" height="12"/>
					<textElement verticalAlignment="Middle">
						<font size="9" isBold="true" pdfFontName="Helvetica-Bold"/>
					</textElement>
					<textFieldExpression class="java.lang.String"><![CDATA[$F{group_name}]]></textFieldExpression>
				</textField>
				<staticText>
					<reportElement x="96" y="3" width="7" height="15"/>
					<textElement textAlignment="Left" verticalAlignment="Middle">
						<font size="12" isBold="true" pdfFontName="Helvetica-Bold"/>
					</textElement>
					<text><![CDATA[:]]></text>
				</staticText>
				<textField>
					<reportElement mode="Opaque" x="2" y="4" width="94" height="13"/>
					<textElement verticalAlignment="Middle">
						<font size="9" isBold="true" pdfFontName="Helvetica-Bold"/>
					</textElement>
					<textFieldExpression class="java.lang.String"><![CDATA[$P{groupByName}]]></textFieldExpression>
				</textField>
			</band>
		</groupHeader>
		<groupFooter>
			<band/>
		</groupFooter>
	</group>
	<group name="sub_total">
		<groupExpression><![CDATA[$F{group_name}]]></groupExpression>
		<groupHeader>
			<band/>
		</groupHeader>
		<groupFooter>
			<band height="17">
				<line>
					<reportElement x="0" y="1" width="802" height="1" forecolor="#A6A6A6"/>
				</line>
				<line>
					<reportElement x="0" y="16" width="802" height="1" forecolor="#A6A6A6"/>
				</line>
				<staticText>
					<reportElement x="0" y="3" width="558" height="13"/>
					<textElement textAlignment="Right">
						<font isBold="true" pdfFontName="Helvetica-Bold"/>
					</textElement>
					<text><![CDATA[ Totals:]]></text>
				</staticText>
				<textField pattern="0.00">
					<reportElement x="559" y="3" width="70" height="13"/>
					<textElement textAlignment="Right">
						<font isBold="true" pdfFontName="Helvetica-Bold"/>
					</textElement>
					<textFieldExpression class="java.math.BigDecimal"><![CDATA[$V{sub_total_discount}]]></textFieldExpression>
				</textField>
				<textField pattern="0.00">
					<reportElement x="628" y="3" width="70" height="13"/>
					<textElement textAlignment="Right">
						<font isBold="true" pdfFontName="Helvetica-Bold"/>
					</textElement>
					<textFieldExpression class="java.math.BigDecimal"><![CDATA[$V{sub_total_tax}]]></textFieldExpression>
				</textField>
				<textField isBlankWhenNull="true">
					<reportElement x="257" y="3" width="263" height="13"/>
					<textElement textAlignment="Right">
						<font isBold="true" pdfFontName="Helvetica-Bold"/>
					</textElement>
					<textFieldExpression class="java.lang.String"><![CDATA[$F{group_name}]]></textFieldExpression>
				</textField>
				<textField pattern="0.00">
					<reportElement x="697" y="3" width="70" height="13"/>
					<textElement textAlignment="Right">
						<font isBold="true" pdfFontName="Helvetica-Bold"/>
					</textElement>
					<textFieldExpression class="java.math.BigDecimal"><![CDATA[$V{sub_total_net_amt}]]></textFieldExpression>
				</textField>
			</band>
		</groupFooter>
	</group>
	<background>
		<band/>
	</background>
	<title>
		<band height="55">
			<textField pattern="dd-MM-yyyy">
				<reportElement x="256" y="40" width="75" height="13"/>
				<textElement textAlignment="Center" verticalAlignment="Bottom"/>
				<textFieldExpression class="java.util.Date"><![CDATA[$P{fromDate}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="400" y="40" width="120" height="13"/>
				<textElement textAlignment="Left" verticalAlignment="Bottom">
					<font size="8" pdfFontName="Helvetica"/>	
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA["(as of " + new SimpleDateFormat("dd-MM-yyyy HH:mm").format(new Date()) + ")"]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="0" y="9" width="802" height="31"/>
				<textElement textAlignment="Center">
					<font size="20" isBold="true" pdfFontName="Helvetica-Bold"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA["Purchase Item Batch Wise Report: By " + $P{groupByName}]]></textFieldExpression>
			</textField>
			<textField pattern="dd-MM-yyyy">
				<reportElement x="334" y="40" width="66" height="13"/>
				<textElement textAlignment="Center" verticalAlignment="Bottom"/>
				<textFieldExpression class="java.util.Date"><![CDATA[$P{toDate}]]></textFieldExpression>
			</textField>
		</band>
	</title>
	<pageHeader>
		<band/>
	</pageHeader>
	<columnHeader>
		<band height="18">
			<line>
				<reportElement x="0" y="3" width="802" height="1"/>
			</line>
			<line>
				<reportElement x="2" y="17" width="800" height="1"/>
			</line>
			<staticText>
				<reportElement x="3" y="4" width="155" height="13"/>
				<textElement>
					<font isBold="true" pdfFontName="Helvetica-Bold"/>
				</textElement>
				<text><![CDATA[Item Name]]></text>
			</staticText>
			<staticText>
				<reportElement x="158" y="4" width="55" height="13"/>
				<textElement>
					<font isBold="true" pdfFontName="Helvetica-Bold"/>
				</textElement>
				<text><![CDATA[Batch No]]></text>
			</staticText>
			<staticText>
				<reportElement x="212" y="4" width="47" height="13"/>
				<textElement>
					<font isBold="true" pdfFontName="Helvetica-Bold"/>
				</textElement>
				<text><![CDATA[Mfr]]></text>
			</staticText>
			<staticText>
				<reportElement x="258" y="4" width="87" height="13"/>
				<textElement>
					<font isBold="true" pdfFontName="Helvetica-Bold"/>
				</textElement>
				<text><![CDATA[Supplier Name]]></text>
			</staticText>
			<staticText>
				<reportElement x="344" y="4" width="57" height="13"/>
				<textElement>
					<font isBold="true" pdfFontName="Helvetica-Bold"/>
				</textElement>
				<text><![CDATA[Tax Type%]]></text>
			</staticText>
			<staticText>
				<reportElement x="400" y="4" width="45" height="13"/>
				<textElement textAlignment="Right">
					<font isBold="true" pdfFontName="Helvetica-Bold"/>
				</textElement>
				<text><![CDATA[Quantity]]></text>
			</staticText>
			<staticText>
				<reportElement x="444" y="4" width="47" height="13"/>
				<textElement textAlignment="Right">
					<font isBold="true" pdfFontName="Helvetica-Bold"/>
				</textElement>
				<text><![CDATA[Bonus]]></text>
			</staticText>
			<staticText>
				<reportElement x="490" y="4" width="70" height="13"/>
				<textElement textAlignment="Right">
					<font isBold="true" pdfFontName="Helvetica-Bold"/>
				</textElement>
				<text><![CDATA[Rate]]></text>
			</staticText>
			<staticText>
				<reportElement x="559" y="4" width="70" height="13"/>
				<textElement textAlignment="Right">
					<font isBold="true" pdfFontName="Helvetica-Bold"/>
				</textElement>
				<text><![CDATA[Discount]]></text>
			</staticText>
			<staticText>
				<reportElement x="628" y="4" width="70" height="13"/>
				<textElement textAlignment="Right">
					<font isBold="true" pdfFontName="Helvetica-Bold"/>
				</textElement>
				<text><![CDATA[Tax Amt]]></text>
			</staticText>
			<staticText>
				<reportElement x="697" y="3" width="70" height="13"/>
				<textElement textAlignment="Right">
					<font isBold="true" pdfFontName="Helvetica-Bold"/>
				</textElement>
				<text><![CDATA[Net Amt]]></text>
			</staticText>
		</band>
	</columnHeader>
	<detail>
		<band height="14">
			<textField>
				<reportElement x="3" y="0" width="155" height="13"/>
				<textElement>
					<font size="9" pdfFontName="Helvetica"/>	
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{medicine_name}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="158" y="0" width="55" height="13"/>
				<textElement>
					<font size="9" pdfFontName="Helvetica"/>	
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{batch_no}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="212" y="0" width="47" height="13"/>
				<textElement>
					<font size="9" pdfFontName="Helvetica"/>	
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{manf_mnemonic}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement x="258" y="0" width="87" height="13"/>
				<textElement>
					<font size="9" pdfFontName="Helvetica"/>	
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{supplier_name}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement x="345" y="0" width="22" height="13"/>
				<textElement textAlignment="Right">
					<font size="9" pdfFontName="Helvetica"/>	
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{tax_name}]]></textFieldExpression>
			</textField>
			<textField pattern="###0">
				<reportElement x="366" y="0" width="35" height="13"/>
				<textElement textAlignment="Center">
					<font size="9" pdfFontName="Helvetica"/>	
				</textElement>
				<textFieldExpression class="java.math.BigDecimal"><![CDATA[$F{itemwise_tax_per}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="400" y="1" width="45" height="13"/>
				<textElement textAlignment="Right">
					<font size="9" pdfFontName="Helvetica"/>	
				</textElement>
				<textFieldExpression class="java.math.BigDecimal"><![CDATA[$F{billed_qty}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="444" y="0" width="47" height="13"/>
				<textElement textAlignment="Right">
					<font size="9" pdfFontName="Helvetica"/>	
				</textElement>
				<textFieldExpression class="java.math.BigDecimal"><![CDATA[$F{bonus_qty}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="490" y="0" width="70" height="13"/>
				<textElement textAlignment="Right">
					<font size="9" pdfFontName="Helvetica"/>	
				</textElement>
				<textFieldExpression class="java.math.BigDecimal"><![CDATA[$F{cost_price}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="559" y="0" width="70" height="13"/>
				<textElement textAlignment="Right">
					<font size="9" pdfFontName="Helvetica"/>	
				</textElement>
				<textFieldExpression class="java.math.BigDecimal"><![CDATA[$F{itemwise_discount}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="628" y="0" width="70" height="13"/>
				<textElement textAlignment="Right">
					<font size="9" pdfFontName="Helvetica"/>	
				</textElement>
				<textFieldExpression class="java.math.BigDecimal"><![CDATA[$F{itemwise_tax_amount}]]></textFieldExpression>
			</textField>
			<textField pattern="0.00">
				<reportElement x="697" y="0" width="70" height="13"/>
				<textElement textAlignment="Right">
					<font size="9" pdfFontName="Helvetica"/>	
				</textElement>
				<textFieldExpression class="java.math.BigDecimal"><![CDATA[$F{net_amount}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
	<columnFooter>
		<band/>
	</columnFooter>
	<pageFooter>
		<band/>
	</pageFooter>
	<summary>
		<band/>
	</summary>
	<noData>
		<band height="38">
			<staticText>
				<reportElement x="2" y="10" width="766" height="28"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="20" isBold="true" pdfFontName="Helvetica-Bold"/>
				</textElement>
				<text><![CDATA[No Data was found for the given criteria.]]></text>
			</staticText>
		</band>
	</noData>
</jasperReport>
