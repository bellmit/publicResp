<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="HospitalDayBookTestReport" pageWidth="595" pageHeight="842" whenNoDataType="NoDataSection" columnWidth="555" leftMargin="20" rightMargin="20" topMargin="40" bottomMargin="40">
	<parameter name="fromDateTime" class="java.sql.Timestamp" isForPrompting="false">
		<defaultValueExpression><![CDATA[java.sql.Timestamp.valueOf("2010-04-01 00:00:00")]]></defaultValueExpression>
	</parameter>
	<parameter name="toDateTime" class="java.sql.Timestamp" isForPrompting="false">
		<defaultValueExpression><![CDATA[java.sql.Timestamp.valueOf("2011-03-31 23:59:59")]]></defaultValueExpression>
	</parameter>
	<parameter name="visitType" class="java.lang.String" isForPrompting="false">
		<defaultValueExpression><![CDATA[""]]></defaultValueExpression>
	</parameter>
	<parameter name="userName" class="java.lang.String" isForPrompting="false">
		<defaultValueExpression><![CDATA[""]]></defaultValueExpression>
	</parameter>
	<parameter name="countername" class="java.lang.String" isForPrompting="false">
		<defaultValueExpression><![CDATA[""]]></defaultValueExpression>
	</parameter>
	<parameter name="allCounters" class="java.lang.Boolean" isForPrompting="false">
		<defaultValueExpression><![CDATA[java.lang.Boolean.valueOf(false)]]></defaultValueExpression>
	</parameter>
	<parameter name="SUBREPORT_DIR" class="java.lang.String">
		<defaultValueExpression><![CDATA["/home/vasan.srini/workspace/instahms/WEB-INF/jasper"]]></defaultValueExpression>
	</parameter>
	<parameter name="bills" class="java.lang.String" isForPrompting="false">
		<defaultValueExpression><![CDATA[""]]></defaultValueExpression>
	</parameter>
	<parameter name="centers" class="java.lang.String" isForPrompting="false">
		<defaultValueExpression><![CDATA[""]]></defaultValueExpression>
	</parameter>
	<parameter name="receipts" class="java.lang.String" isForPrompting="false">
		<defaultValueExpression><![CDATA[""]]></defaultValueExpression>
	</parameter>
	<parameter name="paymentMode" class="java.lang.String">
		<defaultValueExpression><![CDATA[""]]></defaultValueExpression>
	</parameter>
	<queryString>
		<![CDATA[SELECT * from
(
SELECT CASE WHEN r.receipt_type='R' AND r.tpa_id IS null AND NOT r.is_deposit THEN 'Bill Receipts' 
  			  WHEN r.receipt_type='F' AND r.tpa_id IS null AND NOT r.is_deposit THEN 'Bill Refunds'
  			  WHEN r.receipt_type='R' AND r.tpa_id IS NOT null AND NOT r.is_deposit THEN 'Sponsor Receipts'  
  			  WHEN r.receipt_type='R' AND r.is_deposit THEN 'Deposits'  
  			  WHEN r.receipt_type='F' AND r.is_deposit THEN 'Deposit Refund' END
  			  AS main_type, 
	CASE WHEN r.receipt_type='R' AND r.tpa_id IS null THEN 'R' 
  		 WHEN r.receipt_type='F' AND r.tpa_id IS null THEN 'F'
  		 WHEN r.receipt_type='R' AND r.tpa_id IS NOT null THEN 'S' END 
	AS payment_type,
    CASE  WHEN receipt_type = 'F' THEN 'F'
    WHEN tpa_id IS NOT NULL THEN 'SP'
    WHEN is_deposit THEN 'D'
    WHEN  is_settlement THEN 'S'
    WHEN  NOT is_settlement THEN 'A'
    END AS sub_type,
	r.payment_mode_id ,r.card_type_id,
	pm.payment_mode ,ctm.card_type, r.bank_name, r.reference_no,
	r.receipt_id as receipt_no, CASE WHEN NOT r.is_deposit THEN b.bill_no ELSE '' END as bill_no, CASE WHEN NOT r.is_deposit THEN b.bill_type ELSE '' END as bill_type, CASE WHEN NOT r.is_deposit THEN b.visit_type ELSE '' END AS visittype,
	pd.mr_no, pr.patient_id, pr.op_type,
	COALESCE (get_patient_full_name(sm.salutation, pd.patient_name, pd.middle_name, pd.last_name),
	prc.customer_name, isr.patient_name) AS patname, r.created_by as username, 
	concat(r.created_by, '(',u.temp_username, ')' ) AS temp_username,
	r.counter, c.counter_no,CASE WHEN c.counter_type='B' THEN 'Billing' ELSE 'Pharmacy' END AS counter_type,
	CASE WHEN c.collection_counter='Y' THEN 'Yes' ELSE 'No' END AS collection_counter,
	CASE WHEN ma.activation_status = 'Y' THEN br.allocated_amount ELSE r.amount END AS amt, r.display_date AS date,
	r.tds_amount AS tds_amt,
	r.bank_batch_no, r.card_auth_code, r.card_holder_name, r.currency_id, r.exchange_rate,
	r.exchange_date, r.currency_amt, r.card_exp_date AS card_expdate, r.card_number, fc.currency, c.center_id
	FROM receipts r 
	LEFT JOIN bill_receipts br ON r.receipt_id = br.receipt_no AND NOT r.is_deposit
	LEFT JOIN  bill b ON b.bill_no = br.bill_no
	LEFT JOIN patient_registration pr ON pr.patient_id = b.visit_id
	LEFT JOIN patient_details pd ON r.mr_no = pd.mr_no
	LEFT JOIN salutation_master sm ON (sm.salutation_id = pd.salutation)
	LEFT JOIN store_retail_customers prc ON prc.customer_id = b.visit_id
	LEFT JOIN incoming_sample_registration isr ON isr.incoming_visit_id = b.visit_id
	JOIN counters c on c.counter_id = r.counter
	JOIN payment_mode_master pm ON (r.payment_mode_id = pm.mode_id)
	LEFT JOIN card_type_master ctm ON (r.card_type_id = ctm.card_type_id)
	LEFT JOIN foreign_currency fc ON (fc.currency_id = r.currency_id)
	LEFT JOIN u_user u ON r.created_by = u.emp_username
	LEFT JOIN modules_activated ma ON module_id = 'mod_ins_ext'
	WHERE date_trunc('sec',r.display_date) between  $P{fromDateTime} and $P{toDateTime} AND r.receipt_type != 'W' AND r.payment_mode_id<>-9

UNION ALL
SELECT 'Payments' AS main_type, '' AS payment_type, payment_type AS sub_type,
	p.payment_mode_id,p.card_type_id,pm.payment_mode, ctm.card_type, p.bank AS bank_name, p.reference_no,
	voucher_no, '' AS bill_no, '' AS bill_type, '' AS visit_type, '' AS mr_no, '' AS patient_id,'' AS op_type,
	CASE
		WHEN payment_type='D' THEN (SELECT doctor_name FROM doctors WHERE  doctor_id=payee_name)
		WHEN payment_type='R' THEN (SELECT doctor_name FROM  doctors WHERE doctor_id=payee_name)
		WHEN payment_type='F' THEN (SELECT referal_name FROM  referral where referal_no=payee_name)
		WHEN payment_type='O' THEN (SELECT oh_name FROM  outhouse_master where oh_id=payee_name)
		WHEN payment_type='P' THEN (SELECT doctor_name FROM doctors WHERE  doctor_id=payee_name)
		WHEN payment_type='S' THEN (SELECT supplier_name FROM supplier_master WHERE  supplier_code=payee_name)
		ELSE payee_name END AS patname, username AS username, concat(username, '(',u.temp_username, ')' ) AS temp_username,
	counter, c.counter_no,
	CASE WHEN c.counter_type='B' THEN 'Billing' ELSE 'Pharmacy' END AS counter_type,
	CASE WHEN c.collection_counter='Y' THEN 'Yes' ELSE 'No' END AS collection_counter,
	(0-amount) AS amt, date, 0.00 AS tds_amt,
	null, null, null, null, null,
	null, null, null, null, null, c.center_id
FROM payments p
	JOIN counters c on c.counter_id = p.counter
	JOIN payment_mode_master pm ON (p.payment_mode_id = pm.mode_id)
	LEFT JOIN card_type_master ctm ON (p.card_type_id = ctm.card_type_id)
	LEFT JOIN u_user u ON (u.emp_username = p.username)
	WHERE date_trunc('sec',date) between  $P{fromDateTime} and $P{toDateTime}

UNION ALL
	SELECT 'Consolidated Claim Receipts' AS main_type, 'S' AS payment_type,
	'Consolidated Claim Receipts' AS sub_type, icr.payment_mode_id,icr.card_type_id,
	pm.payment_mode,  ctm.card_type, icr.bank_name, icr.reference_no,
	receipt_no, '' as sponsor_bill_no, '' as bill_type, '' as visit_type, '' as mr_no,
	'' as patient_id, '' AS op_type, tpa_name||','||insurance_co_name AS pat_name, icr.username AS username,
	concat(icr.username, '(' , u.temp_username, ')' ) AS temp_username,
	icr.counter, c.counter_no,
	CASE WHEN c.counter_type='B' THEN 'Billing' ELSE 'Pharmacy' END AS counter_type,
	CASE WHEN c.collection_counter='Y' THEN 'Yes' ELSE 'No' END AS collection_counter,
	amount , display_date, 0,
	icr.bank_batch_no, icr.card_auth_code, icr.card_holder_name, icr.currency_id, icr.exchange_rate,
	icr.exchange_date, icr.currency_amt, icr.card_expdate, icr.card_number, fc.currency, c.center_id
	FROM insurance_claim_receipt icr
	JOIN u_user u ON icr.username = u.emp_username
	LEFT JOIN tpa_master tp ON (tp.tpa_id = icr.tpa_id)
	LEFT JOIN insurance_company_master ic ON (ic.insurance_co_id = icr.insurance_co_id)
	JOIN counters c on c.counter_id = icr.counter
	JOIN payment_mode_master pm ON (icr.payment_mode_id = pm.mode_id)
	LEFT JOIN card_type_master ctm ON (icr.card_type_id = ctm.card_type_id)
	LEFT JOIN foreign_currency fc ON (fc.currency_id = icr.currency_id)
	WHERE date_trunc('sec',display_date) between  $P{fromDateTime} and $P{toDateTime}
)AS foo

WHERE 1=1 $P!{countername} $P!{userName} $P!{bills} $P!{receipts} $P!{visitType} $P!{paymentMode}
$P!{centers}
ORDER BY username, payment_mode, main_type, date, receipt_no
;]]>
	</queryString>
	<field name="mr_no" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="patname" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="bill_type" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="receipt_no" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="amt" class="java.math.BigDecimal">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="main_type" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="sub_type" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="counter_no" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="temp_username" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="payment_mode" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="bill_no" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="date" class="java.sql.Timestamp">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="center_id" class="java.lang.Integer"/>
	<variable name="sumamount" class="java.math.BigDecimal" resetType="Group" resetGroup="main_type" calculation="Sum">
		<variableExpression><![CDATA[$F{amt}]]></variableExpression>
	</variable>
	<variable name="usertotal" class="java.math.BigDecimal" resetType="Group" resetGroup="temp_username" calculation="Sum">
		<variableExpression><![CDATA[$F{amt}]]></variableExpression>
	</variable>
	<variable name="type" class="java.lang.String" resetType="Group" resetGroup="main_type" incrementType="Group" incrementGroup="main_type">
		<variableExpression><![CDATA[$F{main_type}]]></variableExpression>
	</variable>
	<group name="summarysubreport">
		<groupHeader>
			<band height="36">
				<subreport>
					<reportElement x="0" y="0" width="555" height="36"/>
					<subreportParameter name="countername">
						<subreportParameterExpression><![CDATA[$P{countername}]]></subreportParameterExpression>
					</subreportParameter>
					<subreportParameter name="paymentMode">
						<subreportParameterExpression><![CDATA[$P{paymentMode}]]></subreportParameterExpression>
					</subreportParameter>
					<subreportParameter name="fromdateTime">
						<subreportParameterExpression><![CDATA[$P{fromDateTime}]]></subreportParameterExpression>
					</subreportParameter>
					<subreportParameter name="receipts">
						<subreportParameterExpression><![CDATA[$P{receipts}]]></subreportParameterExpression>
					</subreportParameter>
					<subreportParameter name="centers">
						<subreportParameterExpression><![CDATA[$P{centers}]]></subreportParameterExpression>
					</subreportParameter>
					<subreportParameter name="userName">
						<subreportParameterExpression><![CDATA[$P{userName}]]></subreportParameterExpression>
					</subreportParameter>
					<subreportParameter name="todateTime">
						<subreportParameterExpression><![CDATA[$P{toDateTime}]]></subreportParameterExpression>
					</subreportParameter>
					<subreportParameter name="bills">
						<subreportParameterExpression><![CDATA[$P{bills}]]></subreportParameterExpression>
					</subreportParameter>
					<subreportParameter name="visitType">
						<subreportParameterExpression><![CDATA[$P{visitType}]]></subreportParameterExpression>
					</subreportParameter>
					<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
					<subreportExpression class="java.lang.String"><![CDATA[$P{SUBREPORT_DIR} + "/DaybookSummary.jasper"]]></subreportExpression>
				</subreport>
			</band>
		</groupHeader>
	</group>
	<group name="daybookheaders">
		<groupHeader>
			<band height="22">
				<staticText>
					<reportElement x="0" y="-21" width="342" height="21"/>
					<textElement textAlignment="Left" verticalAlignment="Middle">
						<font size="12" isBold="true" isUnderline="true" pdfFontName="Helvetica"/>
					</textElement>
					<text><![CDATA[User Collection Details ]]></text>
				</staticText>
				<staticText>
					<reportElement mode="Opaque" x="0" y="5" width="80" height="15" forecolor="#000000" backcolor="#FFFFFF"/>
					<box bottomPadding="1" rightPadding="0">
						<topPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
						<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
						<bottomPen lineWidth="0.5" lineColor="#000000"/>
						<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					</box>
					<textElement verticalAlignment="Middle">
						<font size="8" pdfFontName="Helvetica"/>	
					</textElement>
					<text><![CDATA[Payment Date/Time]]></text>
				</staticText>
				<staticText>
					<reportElement mode="Opaque" x="80" y="5" width="85" height="15" forecolor="#000000" backcolor="#FFFFFF"/>
					<box bottomPadding="1" rightPadding="0">
						<topPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
						<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
						<bottomPen lineWidth="0.5" lineColor="#000000"/>
						<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					</box>
					<textElement verticalAlignment="Middle">
						<font size="8" pdfFontName="Helvetica"/>	
					</textElement>
					<text><![CDATA[Receipt No]]></text>
				</staticText>
				<staticText>
					<reportElement mode="Opaque" x="165" y="5" width="60" height="15" forecolor="#000000" backcolor="#FFFFFF"/>
					<box bottomPadding="1" rightPadding="0">
						<topPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
						<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
						<bottomPen lineWidth="0.5" lineColor="#000000"/>
						<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					</box>
					<textElement verticalAlignment="Middle">
						<font size="8" pdfFontName="Helvetica"/>	
					</textElement>
					<text><![CDATA[Type]]></text>
				</staticText>
				<staticText>
					<reportElement mode="Opaque" x="225" y="5" width="85" height="15" forecolor="#000000" backcolor="#FFFFFF"/>
					<box bottomPadding="1" rightPadding="0">
						<topPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
						<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
						<bottomPen lineWidth="0.5" lineColor="#000000"/>
						<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					</box>
					<textElement verticalAlignment="Middle">
						<font size="8" pdfFontName="Helvetica"/>	
					</textElement>
					<text><![CDATA[MR No]]></text>
				</staticText>
				<staticText>
					<reportElement mode="Opaque" x="310" y="5" width="85" height="15" forecolor="#000000" backcolor="#FFFFFF"/>
					<box bottomPadding="1" rightPadding="0">
						<topPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
						<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
						<bottomPen lineWidth="0.5" lineColor="#000000"/>
						<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					</box>
					<textElement textAlignment="Left" verticalAlignment="Middle">
						<font size="8" pdfFontName="Helvetica"/>	
					</textElement>
					<text><![CDATA[Bill No]]></text>
				</staticText>
				<staticText>
					<reportElement mode="Opaque" x="395" y="5" width="85" height="15" forecolor="#000000" backcolor="#FFFFFF"/>
					<box bottomPadding="1" rightPadding="0">
						<topPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
						<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
						<bottomPen lineWidth="0.5" lineColor="#000000"/>
						<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					</box>
					<textElement verticalAlignment="Middle">
						<font size="8" pdfFontName="Helvetica"/>	
					</textElement>
					<text><![CDATA[Patient Name]]></text>
				</staticText>
				<staticText>
					<reportElement mode="Opaque" x="480" y="5" width="75" height="15" forecolor="#000000" backcolor="#FFFFFF"/>
					<box bottomPadding="1" rightPadding="0">
						<topPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
						<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
						<bottomPen lineWidth="0.5" lineColor="#000000"/>
						<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					</box>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font size="8" pdfFontName="Helvetica"/>	
					</textElement>
					<text><![CDATA[Receipt Amount]]></text>
				</staticText>
			</band>
		</groupHeader>
	</group>
	<group name="temp_username">
		<groupExpression><![CDATA[$F{temp_username}]]></groupExpression>
		<groupHeader>
			<band height="17">
				<staticText>
					<reportElement mode="Opaque" x="0" y="0" width="75" height="17" forecolor="#000000" backcolor="#FFFFFF"/>
					<box bottomPadding="1" rightPadding="0">
						<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
						<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
						<bottomPen lineWidth="0.0" lineColor="#000000"/>
						<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					</box>
					<textElement>
						<font size="8" isItalic="false" pdfFontName="Helvetica"/>
					</textElement>
					<text><![CDATA[User Name]]></text>
				</staticText>
				<textField>
					<reportElement mode="Opaque" x="75" y="0" width="465" height="17" forecolor="#000000" backcolor="#FFFFFF"/>
					<box bottomPadding="1" rightPadding="0">
						<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
						<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
						<bottomPen lineWidth="0.0" lineColor="#000000"/>
						<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					</box>
					<textElement>
						<font size="8" isBold="true" isItalic="false" pdfFontName="Helvetica-Bold"/>
					</textElement>
					<textFieldExpression class="java.lang.String"><![CDATA[$F{temp_username}]]></textFieldExpression>
				</textField>
			</band>
		</groupHeader>
		<groupFooter>
			<band height="18">
				<textField>
					<reportElement x="0" y="2" width="455" height="15"/>
					<box bottomPadding="1" rightPadding="0">
						<topPen lineWidth="0.95" lineStyle="Solid" lineColor="#000000"/>
						<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
						<bottomPen lineWidth="0.95" lineColor="#000000"/>
						<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					</box>
					<textElement textAlignment="Right" verticalAlignment="Middle">
						<font size="10" isBold="true" pdfFontName="Helvetica-Bold"/>
					</textElement>
					<textFieldExpression class="java.lang.String"><![CDATA["Grand Total Collection for user "+$F{temp_username}]]></textFieldExpression>
				</textField>
				<textField>
					<reportElement x="455" y="2" width="100" height="15"/>
					<box bottomPadding="1" rightPadding="0">
						<topPen lineWidth="0.95" lineStyle="Solid" lineColor="#000000"/>
						<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
						<bottomPen lineWidth="0.95" lineColor="#000000"/>
						<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					</box>
					<textElement textAlignment="Right" verticalAlignment="Middle">
						<font size="10" isBold="true" pdfFontName="Helvetica-Bold"/>
					</textElement>
					<textFieldExpression class="java.math.BigDecimal"><![CDATA[$V{usertotal}]]></textFieldExpression>
				</textField>
			</band>
		</groupFooter>
	</group>
	<group name="payment_mode">
		<groupExpression><![CDATA[$F{payment_mode}]]></groupExpression>
		<groupHeader>
			<band height="16">
				<staticText>
					<reportElement mode="Opaque" x="0" y="0" width="75" height="14" backcolor="#FFFFFF"/>
					<box bottomPadding="1" rightPadding="0">
						<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
						<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
						<bottomPen lineWidth="0.0" lineColor="#000000"/>
						<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					</box>
					<textElement>
						<font size="8" isItalic="false"/>
					</textElement>
					<text><![CDATA[Payment Mode]]></text>
				</staticText>
				<textField>
					<reportElement mode="Opaque" x="75" y="0" width="465" height="14" backcolor="#FFFFFF"/>
					<box bottomPadding="1" rightPadding="0">
						<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
						<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
						<bottomPen lineWidth="0.0" lineColor="#000000"/>
						<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					</box>
					<textElement>
						<font size="8" isBold="true" isItalic="false" pdfFontName="Helvetica-Bold"/>
					</textElement>
					<textFieldExpression class="java.lang.String"><![CDATA[$F{payment_mode}]]></textFieldExpression>
				</textField>
			</band>
		</groupHeader>
	</group>
	<group name="main_type">
		<groupExpression><![CDATA[$F{main_type}]]></groupExpression>
		<groupHeader>
			<band height="14">
				<textField>
					<reportElement x="0" y="0" width="555" height="14"/>
					<textElement textAlignment="Left">
						<font size="10" isBold="true" isItalic="false" pdfFontName="Helvetica-Bold"/>
					</textElement>
					<textFieldExpression class="java.lang.String"><![CDATA[$F{main_type}]]></textFieldExpression>
				</textField>
			</band>
		</groupHeader>
		<groupFooter>
			<band height="14">
				<textField>
					<reportElement x="100" y="0" width="350" height="14"/>
					<box bottomPadding="1" rightPadding="0">
						<topPen lineWidth="0.75" lineStyle="Solid" lineColor="#000000"/>
						<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
						<bottomPen lineWidth="0.75" lineColor="#000000"/>
						<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					</box>
					<textElement textAlignment="Right" verticalAlignment="Middle">
						<font size="9" isBold="false" isItalic="true" pdfFontName="Helvetica-Oblique"/>
					</textElement>
					<textFieldExpression class="java.lang.String"><![CDATA["Sub-total: ( "+$F{temp_username}+", "+$F{payment_mode}+", "+$V{type}.toString()+" )  "]]></textFieldExpression>
				</textField>
				<textField>
					<reportElement x="455" y="0" width="100" height="14"/>
					<box bottomPadding="1" rightPadding="0">
						<topPen lineWidth="0.75" lineStyle="Solid" lineColor="#000000"/>
						<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
						<bottomPen lineWidth="0.75" lineColor="#000000"/>
						<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					</box>
					<textElement textAlignment="Right" verticalAlignment="Middle">
						<font size="9" isBold="true" pdfFontName="Helvetica-Bold"/>
					</textElement>
					<textFieldExpression class="java.math.BigDecimal"><![CDATA[$V{sumamount}]]></textFieldExpression>
				</textField>
			</band>
		</groupFooter>
	</group>
	<group name="payments"/>
	<background>
		<band/>
	</background>
	<title>
		<band height="30">
			<textField>
				<reportElement x="0" y="0" width="555" height="30"/>
				<box bottomPadding="1" rightPadding="0">
					<topPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.5" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="11" isBold="true" pdfFontName="Helvetica-Bold"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA["Collection Report  From "+
new SimpleDateFormat("dd-MM-yyyy-HH:mm").format($P{fromDateTime}) +" To "+
new SimpleDateFormat("dd-MM-yyyy-HH:mm").format($P{toDateTime}) +
"  For  "+(	$P{allCounters}.booleanValue() ? "All Counters" : $F{counter_no})]]></textFieldExpression>
			</textField>
		</band>
	</title>
	<pageHeader>
		<band/>
	</pageHeader>
	<detail>
		<band height="15">
			<textField pattern="dd-MM-yyyy HH.mm">
				<reportElement x="0" y="0" width="80" height="15"/>
				<box bottomPadding="1" rightPadding="0">
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement verticalAlignment="Middle">
					<font size="8" pdfFontName="Helvetica"/>	
				</textElement>
				<textFieldExpression class="java.sql.Timestamp"><![CDATA[$F{date}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="80" y="0" width="85" height="15"/>
				<box bottomPadding="1" rightPadding="0">
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement verticalAlignment="Middle">
					<font size="8" pdfFontName="Helvetica"/>	
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{receipt_no}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true">
				<reportElement x="165" y="0" width="60" height="15"/>
				<box bottomPadding="1" rightPadding="0">
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement verticalAlignment="Middle">
					<font size="8" pdfFontName="Helvetica"/>	
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{main_type}.equals("Consolidated Claim Receipts")? "Cons. Claim Receipts":$F{main_type}.equals("Consolidated Sponsor Receipts")? "Cons. Sponsor Receipts":
$F{main_type}.equals("Bill Refunds")? "Refund":
$F{main_type}.equals("Bill Receipts") ?
	$F{sub_type}.equals("F") ?
		$F{bill_type}.equals("C") ? "Bill Later" : "Bill Now" :
	$F{bill_type}.equals("C") ?
		$F{sub_type}.equals("A") ? "Advance" : "Settlement" :
		"Bill Now" :
$F{main_type}.equals("Sponsor Receipts") ?
		$F{sub_type}.equals("A") ? "Advance" : "Settlement" :
$F{main_type}.equals("Deposits")? "Receipts" :
$F{main_type}.equals("Deposit Refund")? "Returns":
$F{main_type}.equals("Payments") ?
	$F{sub_type}.equals("D") ? "Doctor" :
	$F{sub_type}.equals("R") ? "Referral" :
	$F{sub_type}.equals("F") ? "Referral" :
	$F{sub_type}.equals("P") ? "Presc. Dr." :
	$F{sub_type}.equals("O") ? "Outhouse" :
	$F{sub_type}.equals("S") ? "Supplier" :
	"Misc." :
"Unknown"]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true" isStretchWithOverflow="true">
				<reportElement x="225" y="0" width="85" height="15"/>
				<box bottomPadding="1" rightPadding="0">
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement verticalAlignment="Middle">
					<font size="8" pdfFontName="Helvetica"/>	
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{mr_no}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true">
				<reportElement x="310" y="0" width="85" height="15"/>
				<box bottomPadding="1" rightPadding="0">
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement verticalAlignment="Middle">
					<font size="8" pdfFontName="Helvetica"/>	
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{bill_no}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true">
				<reportElement x="395" y="0" width="85" height="15"/>
				<box bottomPadding="1" rightPadding="0">
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement verticalAlignment="Middle">
					<font size="8" pdfFontName="Helvetica"/>	
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{patname}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="480" y="0" width="75" height="15"/>
				<box bottomPadding="1" rightPadding="0">
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font size="8" pdfFontName="Helvetica"/>	
				</textElement>
				<textFieldExpression class="java.math.BigDecimal"><![CDATA[$F{amt}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
	<columnFooter>
		<band/>
	</columnFooter>
	<pageFooter>
		<band height="32">
			<textField evaluationTime="Report" pattern="" isBlankWhenNull="false">
				<reportElement key="textField" x="540" y="18" width="15" height="13" forecolor="#000000" backcolor="#FFFFFF"/>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement>
					<font size="8" pdfFontName="Helvetica"/>	
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[" " + $V{PAGE_NUMBER}]]></textFieldExpression>
			</textField>
			<textField evaluationTime="Page" pattern="" isBlankWhenNull="false">
				<reportElement key="textField" x="373" y="18" width="166" height="13" forecolor="#000000" backcolor="#FFFFFF"/>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Right">
					<font size="8" pdfFontName="Helvetica"/>	
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA["Page " + $V{PAGE_NUMBER} + " of "]]></textFieldExpression>
			</textField>
			<textField pattern="dd-MM-yy HH:mm">
				<reportElement key="textField" x="1" y="18" width="109" height="13" forecolor="#000000" backcolor="#FFFFFF"/>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement>
					<font size="8" pdfFontName="Helvetica"/>	
				</textElement>
				<textFieldExpression class="java.util.Date"><![CDATA[new Date()]]></textFieldExpression>
			</textField>
		</band>
	</pageFooter>
	<summary>
		<band/>
	</summary>
	<noData>
		<band height="27">
			<staticText>
				<reportElement x="0" y="0" width="539" height="27"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="15" isBold="true" pdfFontName="Helvetica-Bold"/>
				</textElement>
				<text><![CDATA[No data for the given date range]]></text>
			</staticText>
		</band>
	</noData>
</jasperReport>
